<nz-layout class="public-layout" ngSkipHydration>
    <!-- Header -->
    <nz-header class="public-header">
      <div class="header-container">
        <!-- Logo -->
        <div class="logo">
          <a routerLink="/">QuickBlog</a>
        </div>
  
        <!-- Desktop Navigation -->
        <div class="desktop-nav">
          <!-- Sử dụng nz-menu cho navigation -->
          <ul nz-menu nzMode="horizontal" class="header-menu">
            <li nz-menu-item>
              <!-- Sử dụng routerLink thay cho href -->
              <a routerLink="/public/posts">Posts</a>
            </li>
            
            <!-- Menu trạng thái đăng nhập/chưa đăng nhập sử dụng ngIf-else -->
            <ng-container *ngIf="!isLoggedIn">    
              <li nz-menu-item>
                <a routerLink="/login">Sign in</a>
              </li>
              <!-- Sử dụng nz-button cho "Get started" -->
              <li nz-menu-item class="no-hover-effect"> <!-- Bỏ hiệu ứng hover mặc định -->
                <a routerLink="/register" nz-button class="get-started-btn">Get started</a>
              </li>
            </ng-container>
            
            <!-- Template cho người dùng đã đăng nhập -->
            <ng-container *ngIf="isLoggedIn">
              <!-- Menu cho người dùng đã đăng nhập -->
              <li nz-menu-item>
                <a routerLink="/blogger/posts">My Posts</a>
              </li>
              <li nz-menu-item>
                <a routerLink="/admin/dashboard">Admin Panel</a>
              </li>

              
              <!-- Avatar và dropdown menu cho người dùng -->
              <li nz-submenu [nzTitle]="userTemplate">
                <ng-template #userTemplate>
                  <nz-avatar 
                    [nzSrc]="currentUser?.avatar || 'assets/images/default-avatar.png'" 
                    nzSize="small">
                  </nz-avatar>
                  <span class="username-text" *ngIf="currentUser">{{ currentUser.username }}</span>
                </ng-template>
                <ul>
                  <li nz-menu-item>
                    <a routerLink="/profile">My Profile</a>
                  </li>
                  <li nz-menu-item>
                    <a routerLink="/settings">Settings</a>
                  </li>
                  <li nz-menu-item (click)="logout()">
                    <span>Logout</span>
                  </li>
                </ul>
              </li>
            </ng-container>
          </ul>
        </div>
  
        <!-- Mobile Menu Trigger -->
        <div class="mobile-trigger">
          <button nz-button nzType="text" (click)="isMobileMenuVisible = true" aria-label="Open menu">
            <span nz-icon nzType="menu"></span>
          </button>
        </div>
      </div>
    </nz-header>
  
    <!-- Mobile Menu Drawer -->
    <nz-drawer
        [nzClosable]="true"
        [nzVisible]="isMobileMenuVisible"
        nzPlacement="right"
        nzTitle="Menu"
        (nzOnClose)="isMobileMenuVisible = false">
      <ng-container *nzDrawerContent>
        <ul nz-menu nzMode="inline" class="mobile-menu-drawer">
          <li nz-menu-item (click)="closeMobileMenu()">
            <a routerLink="/posts">Posts</a>
          </li>
          
          <!-- Menu di động - ngIf-else cho trạng thái đăng nhập -->
          <ng-container *ngIf="!isLoggedIn; else mobileUserLoggedIn">
            <li nz-menu-item (click)="closeMobileMenu()">
              <a routerLink="/login">Sign in</a>
            </li>
            <li nz-menu-item class="no-hover-effect">
              <a routerLink="/register" nz-button nzType="primary" nzBlock class="get-started-btn-mobile" (click)="closeMobileMenu()">Get started</a>
            </li>
          </ng-container>
          
          <!-- Template menu di động cho người dùng đã đăng nhập -->
          <ng-template #mobileUserLoggedIn>
            <li nz-menu-divider></li>
            <li nz-menu-item *ngIf="hasRole(['blogger', 'admin'])" (click)="closeMobileMenu()">
              <a routerLink="/dashboard">Dashboard</a>
            </li>
            <li nz-menu-item *ngIf="hasRole('blogger')" (click)="closeMobileMenu()">
              <a routerLink="/blogger/posts">My Posts</a>
            </li>
            <li nz-menu-item *ngIf="hasRole('admin')" (click)="closeMobileMenu()">
              <a routerLink="/admin/dashboard">Admin Panel</a>
            </li>
            <li nz-menu-divider></li>
            <li nz-menu-item (click)="closeMobileMenu()">
              <a routerLink="/profile">My Profile</a>
            </li>
            <li nz-menu-item (click)="closeMobileMenu()">
              <a routerLink="/settings">Settings</a>
            </li>
            <li nz-menu-item (click)="logout(); closeMobileMenu()">
              <span>Logout</span>
            </li>
          </ng-template>
        </ul>
      </ng-container>
    </nz-drawer>
  
    <!-- Content Area -->
    <nz-content class="public-content">
      <!-- Nội dung của từng trang sẽ được hiển thị ở đây -->
      <router-outlet></router-outlet>
    </nz-content>
  
    <!-- Footer -->
    <nz-footer class="public-footer">
      <div class="footer-container">
        <span class="copyright-text">
          © 2025 <a routerLink="/" class="footer-link">QuickBlog™</a>. All Rights Reserved.
        </span>
        <nav class="footer-nav">
          <a routerLink="/blog" class="footer-link">Blog</a>
          <a routerLink="/privacy" class="footer-link">Privacy</a>
          <a routerLink="/terms" class="footer-link">Terms</a>
          <a routerLink="/teams" class="footer-link">Teams</a>
        </nav>
      </div>
    </nz-footer>
  </nz-layout>